{"schema_version":3,"name":"Prompt Timer","description":"This is an example of prompting a user for an action, but continuing on with a workflow after an hour if a user does not respond. This can be helpful for time sensitive actions like confirming suspicious logins.","guid":"b44134c1ba982b74508c6356b0a886db","exported_at":"2020-12-08T18:13:23Z","agents":[{"type":"Agents::HTTPRequestAgent","name":"Search User by Email in Slack","disabled":false,"guid":"fc9a5af5b9dae5cc95125d14e049ccbb","options":{"url":"https://slack.com/api/users.lookupByEmail","content_type":"json","method":"get","payload":{"email":"{{.receive_alert.body.email}}"},"headers":{"Authorization":"Bearer {{.CREDENTIAL.slack}}"}},"schedule":null,"keep_events_for":0},{"type":"Agents::EventTransformationAgent","name":"Delay Event 1 Hour","disabled":false,"guid":"bc7be45edd5ee2c163dba20f8e9e81ad","options":{"mode":"delay","seconds":3600},"keep_events_for":0},{"type":"Agents::TriggerAgent","name":"Catch Prompt Response","disabled":false,"guid":"bace3e9d84ff4d25f2f3feb3275d4a00","options":{"rules":[{"type":"regex","path":"{{.send_message_to_user_in_slack_to_confirm.prompt.status}}","value":"^$"}]},"keep_events_for":0},{"type":"Agents::HTTPRequestAgent","name":"Send message to user in Slack to confirm","disabled":false,"guid":"557610f32adc30685d99af9d5db15a3f","options":{"url":"https://slack.com/api/chat.postMessage","content_type":"json","method":"post","payload":{"channel":"{{.search_user_by_email_in_slack.body.user.id}}","attachments":[{"blocks":[{"type":"section","text":{"type":"mrkdwn","text":"{{.receive_alerts.body.message}}"}},{"type":"section","fields":[{"type":"mrkdwn","text":"*action:*{% line_break %}{{.suspicious_alert_webhook.user_message}}"}]},{"type":"actions","elements":[{"type":"button","text":{"type":"plain_text","emoji":true,"text":"This Was Me"},"style":"primary","url":"{% prompt true %}"},{"type":"button","text":{"type":"plain_text","emoji":true,"text":"I don't recognize this"},"style":"danger","url":"{% prompt invalid %}"}]}]}]},"headers":{"Authorization":"Bearer {{.CREDENTIAL.slack}}"},"log_error_on_status":[]},"schedule":null,"keep_events_for":0},{"type":"Agents::EventTransformationAgent","name":"Deduplicate Events","disabled":false,"guid":"9215cc73e8cf6873b4a7d2d04a6c1685","options":{"mode":"deduplicate","lookback":"100","path":"{% story_run_guid %}"},"keep_events_for":0},{"type":"Agents::TriggerAgent","name":"User Confirmed","disabled":false,"guid":"dd9b60d766c0882c89c3397479d0c9a7","options":{"rules":[{"type":"regex","value":"true","path":"{{.send_message_to_user_in_slack_to_confirm.prompt.status}}"}]},"keep_events_for":0},{"type":"Agents::TriggerAgent","name":"No Response","disabled":false,"guid":"4fb79ac3918158c3e25a46b1e0dab9ad","options":{"rules":[{"type":"regex","value":".","path":"{{.delay_event_24_hours.delay}}"}]},"keep_events_for":0}],"links":[{"source":0,"receiver":3},{"source":1,"receiver":4},{"source":2,"receiver":4},{"source":3,"receiver":1},{"source":3,"receiver":2},{"source":4,"receiver":6},{"source":4,"receiver":5}],"diagram_layout":"{\"4fb79ac3918158c3e25a46b1e0dab9ad\":[-15,690],\"dd9b60d766c0882c89c3397479d0c9a7\":[-270,690],\"9215cc73e8cf6873b4a7d2d04a6c1685\":[-135,615],\"557610f32adc30685d99af9d5db15a3f\":[-135,390],\"bace3e9d84ff4d25f2f3feb3275d4a00\":[-135,495],\"bc7be45edd5ee2c163dba20f8e9e81ad\":[90,495],\"fc9a5af5b9dae5cc95125d14e049ccbb\":[-135,300]}","send_to_story_enabled":false,"entry_agent_guid":null,"exit_agent_guid":null,"send_to_stories":[],"form":{"name":"New story for tuckner329@gmail.com Form","description":"","fields":[],"visibility":"tenant","agent_guid":null,"success_message":"Thank you for your submission"}}